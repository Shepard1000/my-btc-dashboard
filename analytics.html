<!DOCTYPE html>
<html>
<head>
  <title>BTCUSD Analytics</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <h1>BTCUSD Analytics Dashboard</h1>

  <div id="lineChart" style="width:800px;height:500px;"></div>
  <div id="volumeBar" style="width:800px;height:500px;"></div>
  <div id="returnsHistogram" style="width:800px;height:500px;"></div>

  <script>
    async function loadData() {
      const response = await fetch("https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=1h&limit=100");
      const data = await response.json();

      // Extract time, close price, and volume
      const times = data.map(candle => new Date(candle[0]));
      const closes = data.map(candle => parseFloat(candle[4]));
      const volumes = data.map(candle => parseFloat(candle[5]));

      // Compute returns (% change between closes)
      const returns = [];
      for (let i = 1; i < closes.length; i++) {
        const pctChange = ((closes[i] - closes[i-1]) / closes[i-1]) * 100;
        returns.push(pctChange);
      }

      // Line chart: BTCUSD closing prices
      Plotly.newPlot('lineChart', [{
        x: times,
        y: closes,
        type: 'scatter',
        mode: 'lines',
        line: {color: 'blue'}
      }], {title: 'BTCUSD Closing Price (Binance feed)'});

      // Bar chart: volumes
      Plotly.newPlot('volumeBar', [{
        x: times,
        y: volumes,
        type: 'bar',
        marker: {color: 'orange'}
      }], {title: 'BTCUSD Volume (Binance feed)'});

      // Histogram: distribution of returns
      Plotly.newPlot('returnsHistogram', [{
        x: returns,
        type: 'histogram',
        marker: {color: 'green'}
      }], {title: 'Distribution of Hourly Returns (%)'});
    }

    loadData();
  </script>
</body>
</html>
